<?php
// src/autoload.php

/**
 * PSR-4 Autoloader Implementation
 * 
 * Ця функція відповідає за трансляцію логічного шляху класу (Namespace)
 * у фізичний шлях файлової системи.
 */
spl_autoload_register(function ($class) {
    // Префікс простору імен для нашого проекту
    $prefix = 'App\\';

    // Базова директорія для префіксу
    // __DIR__ вказує на поточну папку (src/), тому це і є корінь namespace
    $base_dir = __DIR__. '/';

    // Перевірка: чи належить клас до нашого простору імен?
    // Функція strncmp порівнює перші n символів рядка - це бінарно безпечне порівняння
    $len = strlen($prefix);
    if (strncmp($prefix, $class, $len)!== 0) {
        // Якщо клас не починається з 'App\', передаємо управління наступному автозавантажувачу в черзі SPL
        return;
    }

    // Отримуємо відносне ім'я класу без префіксу 'App\'
    $relative_class = substr($class, $len);

    // Формування шляху до файлу:
    // 1. Беремо базову директорію.
    // 2. Замінюємо неймспейс-сепаратори '\' на системні '/'.
    // 3. Додаємо розширення.php.
    $file = $base_dir. str_replace('\\', '/', $relative_class). '.php';

    // Якщо файл існує, підключаємо його.
    // Важливо використовувати file_exists, щоб уникнути фатальних помилок.
    if (file_exists($file)) {
        require $file;
    }
});
